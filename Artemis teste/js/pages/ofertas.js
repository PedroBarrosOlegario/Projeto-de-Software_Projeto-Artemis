document.addEventListener('DOMContentLoaded', ()=>{ protectPage(['ALUNO','PROFESSOR']); document.getElementById('userInfo').textContent = getSession().user?.nome||''; loadOfertas(); });
async function loadOfertas(){ try{ const list = await apiFetch('/ofertas'); document.getElementById('lista').innerHTML = '<table class="table"><thead><tr><th>Disciplina</th><th>Vagas</th><th>Inscritos</th><th>Ação</th></tr></thead><tbody>'+list.map(o=>`<tr><td>${escapeHtml(o.disciplina?o.disciplina.nome:o.disciplinaNome||'')}</td><td>${o.vagas}</td><td>${o.inscritos||0}</td><td><button class="btn" onclick="inscrever(${o.id})">Inscrever</button></td></tr>`).join('')+'</tbody></table>'; }catch(e){ toast('Erro ao carregar ofertas'); } }
async function inscrever(id){ try{ await apiFetch(`/ofertas/${id}/inscrever`, { method:'POST' }); toast('Inscrição enviada'); }catch(e){ toast('Erro ao inscrever'); } }