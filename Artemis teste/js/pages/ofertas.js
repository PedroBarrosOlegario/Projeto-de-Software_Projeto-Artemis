document.addEventListener('DOMContentLoaded', async ()=>{ const s=getSession(); document.getElementById('userName').textContent = s.user?.nome||''; try{ const list = await apiFetch('/ofertas'); document.getElementById('lista').innerHTML = '<table class="table"><thead><tr><th>Disciplina</th><th>Vagas</th><th>Inscritos</th><th>Ação</th></tr></thead><tbody>'+ (list||[]).map(o=>`<tr><td>${escapeHtml(o.disciplina?.nome||o.disciplinaNome||'')}</td><td>${o.vagas||''}</td><td>${o.inscritos||0}</td><td><button class="btn" onclick="inscrever(${o.id})">Inscrever</button></td></tr>`).join('') + '</tbody></table>'; }catch(e){ document.getElementById('lista').innerHTML='<p>Sem ofertas</p>'; } }); async function inscrever(id){ try{ await apiFetch(`/ofertas/${id}/inscrever`, {method:'POST'}); toast('Inscrição enviada'); }catch(e){ toast('Erro ao inscrever'); } }