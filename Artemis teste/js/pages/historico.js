document.addEventListener('DOMContentLoaded', async ()=>{ const s=getSession(); document.getElementById('userName').textContent = s.user?.nome||''; try{ const list = await apiFetch('/historico'); document.getElementById('lista').innerHTML = '<table class="table"><thead><tr><th>Disciplina</th><th>Nota</th><th>Frequência</th></tr></thead><tbody>'+ (list||[]).map(h=>`<tr><td>${escapeHtml(h.disciplina?.nome||h.disciplinaNome||'')}</td><td>${h.nota||''}</td><td>${h.frequencia||''}</td></tr>`).join('') + '</tbody></table>'; }catch(e){ document.getElementById('lista').innerHTML='<p>Sem histórico</p>'; } });